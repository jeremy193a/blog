---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import BlogPostCard from '../components/BlogPostCard.astro';

const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const sortedPosts = allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const featuredPost = sortedPosts[0];
const otherPosts = sortedPosts.slice(1);

const siteTitle = 'Quang Hà - Make Tech At Ease';
const siteDescription = 'Làm chủ công nghệ thật dễ dàng nhờ những hướng dẫn chi tiết, thực tế và có thể áp dụng ngay vào cuộc sống hay công việc của bạn.';
---

<BaseLayout title={siteTitle} description={siteDescription}>
  <section class="hero hero-grid">
    <div class="hero-copy">
      <h1 class="hero-title">Make Tech At Ease</h1>
      <p class="hero-description">{siteDescription}</p>
      <div class="hero-actions">
        <a class="primary-link" href="#latest">Read the latest</a>
      </div>
    </div>
  </section>

  {featuredPost && (
    <section class="featured-post" id="latest">
      <div class="section-heading">
        <h2 class="section-title">Lead Story</h2>
        <span class="section-line" aria-hidden="true"></span>
      </div>
      <BlogPostCard post={featuredPost} isLead={true} />
    </section>
  )}

  {otherPosts.length > 0 && (
    <section class="post-grid-section">
      <div class="section-heading">
        <h2 class="section-title">Archive</h2>
        <span class="section-line" aria-hidden="true"></span>
      </div>
      <div class="post-grid">
        {otherPosts.map(post => <BlogPostCard post={post} />)}
      </div>
    </section>
  )}
</BaseLayout>
